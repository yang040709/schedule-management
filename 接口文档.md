# ä¹ æƒ¯ç®¡ç† API æ–‡æ¡£

**ç‰ˆæœ¬ï¼š1.0**  
**æœ€åæ›´æ–°ï¼š2025-11-20**

---

## ğŸŒŸ æ¦‚è¿°

æœ¬ API ä¸“ä¸ºä¹ æƒ¯å…»æˆåº”ç”¨è®¾è®¡ï¼Œæä¾›ä¹ æƒ¯ç®¡ç†ã€æ‰“å¡è®°å½•ã€æˆå°±ç³»ç»Ÿç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚æ‰€æœ‰æ¥å£å‡é‡‡ç”¨ **RESTful é£æ ¼**ï¼Œå“åº”æ ¼å¼ä¸ºæ ‡å‡† JSONï¼Œæ”¯æŒåˆ†é¡µã€è¿‡æ»¤å’Œç»Ÿè®¡åˆ†æã€‚æ•°æ®æ—¶é—´æˆ³å‡ä½¿ç”¨ **ISO 8601 æ ¼å¼**ï¼ˆå¦‚ `2025-11-20T00:00:00Z`ï¼‰ã€‚

> ğŸ’¡ **å°è´´å£«**ï¼šæ¥å£è®¾è®¡æ—¶å·²è€ƒè™‘ç§»åŠ¨ç«¯å‹å¥½æ€§ï¼Œå‚æ•°å‘½åæ¸…æ™°æ˜“ç”¨ï¼Œæ¯”å¦‚ `frequency` ç›´æ¥å¯¹åº” `daily`/`weekly`/`monthly`ï¼Œé¿å…äº†å†—ä½™å­—æ®µã€‚

---

## ğŸ“¦ æ•°æ®æ¨¡å‹ï¼ˆå…³é”®ç»“æ„ï¼‰

### 1. åŸºç¡€ç±»å‹

| ç±»å‹             | è¯´æ˜                     | ç¤ºä¾‹                                                            |
| ---------------- | ------------------------ | --------------------------------------------------------------- |
| `HabitFrequency` | ä¹ æƒ¯é¢‘ç‡                 | `daily`ï¼ˆæ¯æ—¥ï¼‰ã€`weekly`ï¼ˆæ¯å‘¨ï¼‰ã€`monthly`ï¼ˆæ¯æœˆï¼‰            |
| `Goal`           | ç›®æ ‡é…ç½®                 | `{ targetDays: 30, durationMinutes: 30 }`                       |
| `HabitBase`      | ä¹ æƒ¯åŸºç¡€ä¿¡æ¯ï¼ˆä¸å«ç»Ÿè®¡ï¼‰ | `id`, `title`, `description`, `goal`, `frequency`, `category`   |
| `HabitStats`     | ä¹ æƒ¯ç»Ÿè®¡                 | `currentStreak`ï¼ˆå½“å‰è¿ç»­å¤©æ•°ï¼‰ã€`successRate`ï¼ˆæˆåŠŸç‡ï¼Œ0-100ï¼‰ |

### 2. æ ¸å¿ƒå¯¹è±¡

| å¯¹è±¡                | è¯´æ˜               | å…³é”®å­—æ®µ                                                     |
| ------------------- | ------------------ | ------------------------------------------------------------ |
| **`Habit`**         | å®Œæ•´ä¹ æƒ¯ï¼ˆå«ç»Ÿè®¡ï¼‰ | `HabitBase` + `stats`                                        |
| **`CheckInRecord`** | æ‰“å¡è®°å½•           | `date`ï¼ˆYYYY-MM-DDï¼‰ã€`duration`ï¼ˆåˆ†é’Ÿï¼‰ã€`mood`ï¼ˆ1-5åˆ†ï¼‰    |
| **`AllStats`**      | å…¨å±€ç»Ÿè®¡           | `totalCheckedIn`ï¼ˆæ€»æ‰“å¡æ•°ï¼‰ã€`avgSuccessRate`ï¼ˆå¹³å‡æˆåŠŸç‡ï¼‰ |
| **`Achievement`**   | æˆå°±ç³»ç»Ÿ           | `name`ï¼ˆæˆå°±åï¼‰ã€`isUnlocked`ï¼ˆæ˜¯å¦è§£é”ï¼‰                   |

> âœ¨ **è®¾è®¡äº®ç‚¹**ï¼š`ModifyHabitForm` ä¸¥æ ¼é™åˆ¶å¯ä¿®æ”¹å­—æ®µï¼ˆæ’é™¤ `id`/`createdAt` ç­‰ï¼‰ï¼Œé¿å…æ„å¤–è¦†ç›–ï¼Œå®‰å…¨åˆé«˜æ•ˆã€‚

---

## ğŸ”Œ API å‚è€ƒåˆ—è¡¨

---

### âœ… 1. è·å–ä¹ æƒ¯åˆ—è¡¨

**ç«¯ç‚¹**ï¼š`GET /habits`  
**ç”¨é€”**ï¼šåˆ†é¡µæŸ¥è¯¢ä¹ æƒ¯åˆ—è¡¨ï¼Œæ”¯æŒé¢‘ç‡ã€åˆ†ç±»ã€å…³é”®è¯è¿‡æ»¤ã€‚  
**è¯·æ±‚å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `frequency` | `HabitFrequency` | å¦ | `daily`/`weekly`/`monthly` |
| `category` | `string` | å¦ | åˆ†ç±»åç§°ï¼ˆå¦‚ `å¥åº·`ï¼‰ |
| `page` | `number` | å¦ | é¡µç ï¼ˆé»˜è®¤ `1`ï¼‰ |
| `pageSize` | `number` | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ `10`ï¼‰ |
| `search` | `string` | å¦ | æ ‡é¢˜/æè¿°å…³é”®è¯ |

**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "total": 15,
  "data": [
    {
      "id": "hab123",
      "title": "æ¯æ—¥é˜…è¯»30åˆ†é’Ÿ",
      "description": "ä¸“æ³¨é˜…è¯»ï¼Œæå‡è®¤çŸ¥",
      "goal": { "targetDays": 30, "durationMinutes": 30 },
      "frequency": "daily",
      "category": ["å­¦ä¹ "],
      "createdAt": "2025-01-01T00:00:00Z",
      "updatedAt": "2025-11-20T00:00:00Z",
      "stats": {
        "currentStreak": 7,
        "longestStreak": 14,
        "totalCompleted": 7,
        "totalMissed": 0,
        "successRate": 100
      }
    }
  ]
}
```

**é”™è¯¯**ï¼š

- `400 Bad Request`ï¼šå‚æ•°æ— æ•ˆï¼ˆå¦‚ `frequency` å€¼éæ³•ï¼‰
- `500 Internal Server Error`ï¼šæœåŠ¡å¼‚å¸¸

---

### âœ… 2. è·å–ä»Šæ—¥ä¹ æƒ¯ï¼ˆå¾…å®Œæˆï¼‰

**ç«¯ç‚¹**ï¼š`GET /habits/today`  
**ç”¨é€”**ï¼šè¿”å›å½“å¤©éœ€å®Œæˆçš„ä¹ æƒ¯åˆ—è¡¨ï¼ˆè‡ªåŠ¨æŒ‰æ—¥æœŸç­›é€‰ï¼‰ã€‚  
**è¯·æ±‚å‚æ•°**ï¼šæ— 

**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "habits": [
    {
      "id": "hab123",
      "title": "æ¯æ—¥é˜…è¯»30åˆ†é’Ÿ",
      "completed": false, // ä»Šæ—¥æ˜¯å¦å·²å®Œæˆ
      "stats": { ... }
    }
  ],
  "date": "2025-11-20"
}
```

> ğŸ’¡ **è´´å¿ƒè®¾è®¡**ï¼š`completed` å­—æ®µç›´æ¥å‘ŠçŸ¥ä»Šæ—¥çŠ¶æ€ï¼Œæ— éœ€é¢å¤–é€»è¾‘åˆ¤æ–­ã€‚

---

### âœ… 3. æ·»åŠ æ–°ä¹ æƒ¯

**ç«¯ç‚¹**ï¼š`POST /habits`  
**ç”¨é€”**ï¼šåˆ›å»ºæ–°ä¹ æƒ¯ï¼ˆéœ€åŒ…å« `goal` å’Œ `category`ï¼‰ã€‚  
**è¯·æ±‚ä½“**ï¼ˆ`HabitForm`ï¼‰ï¼š

```json
{
  "title": "æ—©èµ·è·‘æ­¥",
  "description": "æ¯å¤©æ—©æ™¨6ç‚¹è·‘æ­¥30åˆ†é’Ÿ",
  "goal": { "targetDays": 30, "durationMinutes": 30 },
  "frequency": "daily",
  "category": ["è¿åŠ¨", "å¥åº·"]
}
```

**å“åº”**ï¼ˆ`201 Created`ï¼‰ï¼š

```json
{
  "habit": {
    "id": "hab456",
    "title": "æ—©èµ·è·‘æ­¥",
    "goal": { "targetDays": 30, "durationMinutes": 30 },
    "stats": { "currentStreak": 0, "successRate": 0, ... }
  }
}
```

**é”™è¯¯**ï¼š

- `400 Bad Request`ï¼š`goal.targetDays` æœªè®¾ç½®æˆ–ä¸ºè´Ÿæ•°

---

### âœ… 4. ä¿®æ”¹ä¹ æƒ¯

**ç«¯ç‚¹**ï¼š`PUT /habits/{id}`  
**ç”¨é€”**ï¼šä¿®æ”¹ä¹ æƒ¯å±æ€§ï¼ˆ**ä»…é™æŒ‡å®šå­—æ®µ**ï¼Œå¦‚ `title`/`goal`ï¼‰ã€‚  
**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | `string` | ä¹ æƒ¯å”¯ä¸€ID |

**è¯·æ±‚ä½“**ï¼ˆ`ModifyHabitForm`ï¼‰ï¼š

```json
{
  "title": "æ—©èµ·è·‘æ­¥30åˆ†é’Ÿ",
  "goal": { "durationMinutes": 45 } // ä»…ä¿®æ”¹æŒç»­æ—¶é—´
}
```

> âš ï¸ **å®‰å…¨æç¤º**ï¼š`ModifyHabitForm` ä»…å…è®¸ä¿®æ”¹ `title`/`description`/`goal`/`frequency`/`category`ï¼Œ**ä¸å¯ä¿®æ”¹ `id`/`stats`**ã€‚

**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "habit": {
    "id": "hab456",
    "title": "æ—©èµ·è·‘æ­¥30åˆ†é’Ÿ",
    "goal": { "targetDays": 30, "durationMinutes": 45 },
    "updatedAt": "2025-11-20T10:30:00Z"
  }
}
```

---

### âœ… 5. åˆ é™¤ä¹ æƒ¯

**ç«¯ç‚¹**ï¼š`DELETE /habits/{id}`  
**ç”¨é€”**ï¼šå½»åº•ç§»é™¤ä¹ æƒ¯ï¼ˆè¿åŒæ‰“å¡è®°å½•ï¼‰ã€‚  
**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | `string` | ä¹ æƒ¯ID |

**å“åº”**ï¼ˆ`204 No Content`ï¼‰ï¼šæ— å†…å®¹

**é”™è¯¯**ï¼š

- `404 Not Found`ï¼šä¹ æƒ¯IDä¸å­˜åœ¨

---

### âœ… 6. æ‰“å¡ä¹ æƒ¯

**ç«¯ç‚¹**ï¼š`POST /habits/check-in`  
**ç”¨é€”**ï¼šå®Œæˆä»Šæ—¥ä¹ æƒ¯æ‰“å¡ï¼ˆéœ€ `habitId` å’Œ `duration`ï¼‰ã€‚  
**è¯·æ±‚ä½“**ï¼ˆ`CheckInForm`ï¼‰ï¼š

```json
{
  "habitId": "hab123",
  "duration": 35, // å®é™…æŒç»­æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
  "notes": "é˜…è¯»äº†ã€Šä¸‰ä½“ã€‹", // å¯é€‰å¤‡æ³¨
  "mood": 4 // å¿ƒæƒ…è¯„åˆ†ï¼ˆ1-5ï¼‰
}
```

**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼šæ— å†…å®¹

> ğŸŒˆ **ç»†èŠ‚ä¼˜åŒ–**ï¼šæ”¯æŒè®°å½•å¿ƒæƒ…å’Œå¤‡æ³¨ï¼Œè®©ä¹ æƒ¯å…»æˆæ›´äººæ€§åŒ–ï¼

---

### âœ… 7. å–æ¶ˆæ‰“å¡

**ç«¯ç‚¹**ï¼š`DELETE /habits/check-in/{habits_id}`  
**ç”¨é€”**ï¼šå–æ¶ˆå½“æ—¥å·²æ‰“å¡è®°å½•ï¼ˆæ³¨æ„ï¼š`habits_id` æ˜¯ä¹ æƒ¯IDï¼Œéæ‰“å¡IDï¼‰ã€‚  
**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `habits_id` | `string` | ä¹ æƒ¯ID |

**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼šæ— å†…å®¹

**é”™è¯¯**ï¼š

- `404 Not Found`ï¼šæ‰“å¡è®°å½•ä¸å­˜åœ¨

---

### âœ… 8. è·å–æ‰“å¡è®°å½•

**ç«¯ç‚¹**ï¼š`GET /habits/{habitId}/records`  
**ç”¨é€”**ï¼šåˆ†é¡µæŸ¥è¯¢æŒ‡å®šä¹ æƒ¯çš„æ‰“å¡å†å²ã€‚  
**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `habitId` | `string` | ä¹ æƒ¯ID |

**æŸ¥è¯¢å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `page` | `number` | é¡µç ï¼ˆé»˜è®¤ `1`ï¼‰ |
| `pageSize` | `number` | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ `10`ï¼‰ |

**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "total": 12,
  "data": [
    {
      "id": "rec789",
      "date": "2025-11-19",
      "duration": 35,
      "mood": 4,
      "notes": "é˜…è¯»äº†ã€Šä¸‰ä½“ã€‹"
    }
  ]
}
```

---

### âœ… 9. è·å–æˆå°±åˆ—è¡¨

**ç«¯ç‚¹**ï¼š`GET /achievements`  
**ç”¨é€”**ï¼šè·å–æ‰€æœ‰æˆå°±ï¼ˆå·²è§£é”/æœªè§£é”çŠ¶æ€ï¼‰ã€‚  
**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "achievements": [
    {
      "id": "ach1",
      "name": "è¿ç»­7å¤©",
      "description": "åšæŒ7å¤©å®Œæˆä¹ æƒ¯",
      "icon": "ğŸŒŸ",
      "unlockedAt": "2025-11-15T00:00:00Z",
      "isUnlocked": true
    }
  ]
}
```

---

### âœ… 10. è·å–å…¨å±€ç»Ÿè®¡

**ç«¯ç‚¹**ï¼š`GET /habits/stats`  
**ç”¨é€”**ï¼šæ±‡æ€»æ‰€æœ‰ä¹ æƒ¯çš„æ‰“å¡æ•°æ®ã€‚  
**å“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "totalCheckedIn": 150, // æ€»æ‰“å¡æ¬¡æ•°
  "avgSuccessRate": 85.2 // å¹³å‡æˆåŠŸç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰
}
```

---

## âš ï¸ é”™è¯¯ç é€ŸæŸ¥è¡¨

| çŠ¶æ€ç  | é”™è¯¯ç±»å‹                | å¸¸è§åŸå›                           |
| ------ | ----------------------- | --------------------------------- |
| `400`  | `Bad Request`           | å‚æ•°æ— æ•ˆï¼ˆå¦‚ `frequency` å€¼é”™è¯¯ï¼‰ |
| `404`  | `Not Found`             | ä¹ æƒ¯/æ‰“å¡è®°å½•ä¸å­˜åœ¨               |
| `405`  | `Method Not Allowed`    | é”™è¯¯çš„HTTPæ–¹æ³•ï¼ˆå¦‚ç”¨GETåˆ ä¹ æƒ¯ï¼‰   |
| `500`  | `Internal Server Error` | æœåŠ¡ç«¯é€»è¾‘é”™è¯¯                    |

---

## ğŸ’¬ é™„ï¼šå¼€å‘è€…å‹å¥½æç¤º

1. **å‚æ•°é»˜è®¤å€¼**ï¼š`page` å’Œ `pageSize` æœªä¼ æ—¶é»˜è®¤ä¸º `1` å’Œ `10`ï¼Œé¿å…å‰ç«¯å¤šæ¬¡å¤„ç†ã€‚
2. **æ—¶é—´ç²¾åº¦**ï¼šæ‰€æœ‰æ—¶é—´å­—æ®µå‡å«æ—¶åŒºï¼ˆ`Z` è¡¨ç¤º UTCï¼‰ï¼Œé¿å…æ—¶åŒºæ··æ·†ã€‚
3. **å®‰å…¨æ€§**ï¼š`ModifyHabitForm` ä¸¥æ ¼é™åˆ¶å­—æ®µï¼Œé˜²æ­¢è¯¯æ“ä½œè¦†ç›–å…³é”®æ•°æ®ã€‚
4. **ç§»åŠ¨ç«¯å‹å¥½**ï¼š`completed` å­—æ®µç›´æ¥è¿”å›ä»Šæ—¥çŠ¶æ€ï¼Œå‡å°‘å®¢æˆ·ç«¯é€»è¾‘ã€‚

> ğŸŒ¼ **æœ€åçš„å°å»ºè®®**ï¼š  
> ä¹ æƒ¯å…»æˆçš„å…³é”®æ˜¯â€œå¯æŒç»­æ€§â€ï¼åˆ«è¿½æ±‚å®Œç¾ï¼Œæ¯å¤©å®Œæˆ10åˆ†é’Ÿçš„å°ç›®æ ‡ï¼Œæ¯”ä¸€å‘¨åªåšä¸€æ¬¡3å°æ—¶çš„è®¡åˆ’æ›´æœ‰æ•ˆå“¦ï½  
> å¦‚æœä½ æ­£åœ¨å¼€å‘ç±»ä¼¼åº”ç”¨ï¼Œéœ€è¦è°ƒæ•´æ¥å£ç»†èŠ‚ï¼Œéšæ—¶æ¥èŠï¼ ğŸ˜„

---

**æ–‡æ¡£ç»“æŸ**

# æ—¥ç¨‹ç®¡ç† API æ–‡æ¡£

**ç‰ˆæœ¬ï¼š1.0**  
**æœ€åæ›´æ–°ï¼š2025-11-20**

---

## ğŸŒŸ æ¦‚è¿°

æœ¬ API æä¾›å®Œæ•´çš„æ—¥ç¨‹ï¼ˆScheduleï¼‰ç®¡ç†åŠŸèƒ½ï¼ŒåŒ…æ‹¬å¢åˆ æ”¹æŸ¥ã€AI è‡ªåŠ¨ç”Ÿæˆä¸å»ºè®®ã€ä»»åŠ¡ä¾èµ–å…³ç³»æ”¯æŒç­‰ã€‚æ‰€æœ‰æ¥å£éµå¾ª RESTful è®¾è®¡è§„èŒƒï¼Œä½¿ç”¨ JSON æ ¼å¼é€šä¿¡ï¼Œæ”¯æŒåˆ†é¡µæŸ¥è¯¢å’ŒçŠ¶æ€è¿‡æ»¤ã€‚

> ğŸ’¡ **ç‰¹è‰²åŠŸèƒ½**ï¼š
>
> - æ”¯æŒä»»åŠ¡ä¾èµ–ï¼ˆ`dependentSchedule` å­—æ®µï¼‰
> - å†…ç½® AI ç”Ÿæˆä¸ä¼˜åŒ–å»ºè®®
> - ç²¾ç»†åŒ–çŠ¶æ€ç®¡ç†ï¼ˆå« `locked` çŠ¶æ€ç”¨äºä¾èµ–æ§åˆ¶ï¼‰

---

## ğŸ“¦ æ•°æ®æ¨¡å‹

### åŸºç¡€ç±»å‹

| ç±»å‹             | è¯´æ˜                                                         |
| ---------------- | ------------------------------------------------------------ |
| `PriorityLevel`  | `'high' \| 'medium' \| 'low'`                                |
| `ScheduleStatus` | `'done' \| 'pending' \| 'expired' \| 'canceled' \| 'locked'` |

### æ ¸å¿ƒå¯¹è±¡

#### `Schedule`

```ts
{
  id: string
  title: string
  description: string
  AIsuggestion?: string          // AI ä¸ºè¯¥æ—¥ç¨‹ç”Ÿæˆçš„å»ºè®®æ–‡æœ¬
  status: ScheduleStatus         // å½“å‰çŠ¶æ€
  priority: PriorityLevel        // ä¼˜å…ˆçº§
  category?: string[]            // åˆ†ç±»æ ‡ç­¾ï¼ˆå¦‚ ["å·¥ä½œ", "å­¦ä¹ "]ï¼‰
  dependentSchedule?: ScheduleNoDependent  // ä¾èµ–çš„çˆ¶ä»»åŠ¡ï¼ˆä¸å«å…¶ä¾èµ–ï¼‰
  createdAt: string              // ISO 8601 æ—¶é—´æˆ³
  updatedAt: string
  date: string                   // æ—¥æœŸï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼‰
  timeOfDay?: {
    startTime: string            // å¦‚ "08:00" æˆ– "08:00:00"
    endTime: string
  }
}
```

#### `ScheduleNoDependent`

ç­‰åŒäº `Schedule`ï¼Œä½† **ä¸åŒ…å« `dependentSchedule` å­—æ®µ**ï¼Œç”¨äºé¿å…å¾ªç¯å¼•ç”¨ã€‚

---

## ğŸ”Œ API æ¥å£è¯¦æƒ…

---

### âœ… 1. è·å–æ—¥ç¨‹åˆ—è¡¨

**ç«¯ç‚¹**ï¼š`GET /schedule`  
**ç”¨é€”**ï¼šåˆ†é¡µæŸ¥è¯¢æ—¥ç¨‹ï¼Œæ”¯æŒæŒ‰çŠ¶æ€ã€ä¼˜å…ˆçº§ã€æ—¥æœŸèŒƒå›´ç­›é€‰ã€‚

**æŸ¥è¯¢å‚æ•°**ï¼ˆ`ScheduleListQuery`ï¼‰ï¼š
| å‚æ•° | ç±»å‹ | å¿…å¡« | è¯´æ˜ |
|------|------|------|------|
| `status` | `ScheduleStatus` | å¦ | è¿‡æ»¤æŒ‡å®šçŠ¶æ€ |
| `priority` | `string` | å¦ | ä¼˜å…ˆçº§ï¼ˆ`high`/`medium`/`low`ï¼‰ |
| `date` | `string` | å¦ | ç²¾ç¡®æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰ |
| `dateRange` | `{ startDate: string, endDate: string }` | å¦ | æ—¥æœŸèŒƒå›´ï¼ˆä¸¤è€…éœ€åŒæ—¶æä¾›ï¼‰ |
| `page` | `number` | å¦ | é¡µç ï¼ˆé»˜è®¤ 1ï¼‰ |
| `pageSize` | `number` | å¦ | æ¯é¡µæ•°é‡ï¼ˆé»˜è®¤ 10ï¼‰ |

**æˆåŠŸå“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "total": 25,
  "data": [
    {
      "id": "sch_001",
      "title": "é¡¹ç›®è¯„å®¡ä¼šè®®",
      "status": "pending",
      "priority": "high",
      "date": "2025-11-25",
      "timeOfDay": { "startTime": "14:00", "endTime": "15:30" },
      "dependentSchedule": {
        "id": "sch_000",
        "title": "å‡†å¤‡ä¼šè®®ææ–™",
        "status": "done",
        "priority": "medium",
        "date": "2025-11-24"
      }
    }
  ]
}
```

---

### âœ… 2. åˆ›å»ºæ—¥ç¨‹

**ç«¯ç‚¹**ï¼š`POST /schedule`  
**ç”¨é€”**ï¼šæ–°å¢ä¸€æ¡æ—¥ç¨‹è®°å½•ã€‚

**è¯·æ±‚ä½“**ï¼ˆ`ScheduleForm`ï¼‰ï¼š

```json
{
  "title": "æ’°å†™å‘¨æŠ¥",
  "description": "æ±‡æ€»æœ¬å‘¨å·¥ä½œè¿›å±•",
  "priority": "medium",
  "category": ["å·¥ä½œ"],
  "dependentId": "sch_002", // å¯é€‰ï¼šä¾èµ–çš„æ—¥ç¨‹ID
  "date": "2025-11-22",
  "timeOfDay": {
    "startTime": "09:00",
    "endTime": "10:00"
  }
}
```

**æˆåŠŸå“åº”**ï¼ˆ`201 Created`ï¼‰ï¼š

```json
{
  "schedule": {
    "id": "sch_003",
    "title": "æ’°å†™å‘¨æŠ¥",
    "status": "pending",
    "createdAt": "2025-11-20T10:30:00Z",
    "updatedAt": "2025-11-20T10:30:00Z"
    // ...å…¶ä»–å­—æ®µ
  }
}
```

---

### âœ… 3. ä¿®æ”¹æ—¥ç¨‹

**ç«¯ç‚¹**ï¼š`PUT /schedule/{id}`  
**ç”¨é€”**ï¼šæ›´æ–°æ—¥ç¨‹ä¿¡æ¯ï¼ˆé™¤ `id`/`createdAt`/`updatedAt` å¤–å‡å¯ä¿®æ”¹ï¼‰ã€‚

**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | `string` | æ—¥ç¨‹å”¯ä¸€ID |

**è¯·æ±‚ä½“**ï¼ˆ`ModifyScheduleForm`ï¼Œ**æ‰€æœ‰å­—æ®µå¯é€‰**ï¼‰ï¼š

```json
{
  "title": "ã€ç´§æ€¥ã€‘æ’°å†™å‘¨æŠ¥",
  "priority": "high",
  "dependentId": null // æ¸…é™¤ä¾èµ–å…³ç³»
}
```

**æˆåŠŸå“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "schedule": {
    "id": "sch_003",
    "title": "ã€ç´§æ€¥ã€‘æ’°å†™å‘¨æŠ¥",
    "priority": "high",
    "dependentSchedule": null,
    "updatedAt": "2025-11-20T11:00:00Z"
  }
}
```

> âš ï¸ æ³¨æ„ï¼šè‹¥ä¼ å…¥ `dependentId`ï¼Œåç«¯å°†è‡ªåŠ¨è§£æå¹¶å¡«å…… `dependentSchedule` å­—æ®µã€‚

---

### âœ… 4. åˆ é™¤æ—¥ç¨‹

**ç«¯ç‚¹**ï¼š`DELETE /schedule/{id}`  
**ç”¨é€”**ï¼šæ°¸ä¹…åˆ é™¤æ—¥ç¨‹ï¼ˆåŠå…¶å­ä»»åŠ¡ä¾èµ–å…³ç³»ï¼‰ã€‚

**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | `string` | æ—¥ç¨‹ID |

**æˆåŠŸå“åº”**ï¼ˆ`204 No Content`ï¼‰ï¼šæ— å†…å®¹

---

### âœ… 5. AI è‡ªåŠ¨ç”Ÿæˆæ—¥ç¨‹

**ç«¯ç‚¹**ï¼š`POST /schedule/ai/generate`  
**ç”¨é€”**ï¼šæ ¹æ®è‡ªç„¶è¯­è¨€æè¿°è‡ªåŠ¨ç”Ÿæˆç»“æ„åŒ–æ—¥ç¨‹ã€‚

**è¯·æ±‚ä½“**ï¼ˆ`GenerateSchedule`ï¼‰ï¼š

```json
{
  "content": "æ˜å¤©ä¸Šåˆ9ç‚¹åˆ°10ç‚¹å¼€é¡¹ç›®å¯åŠ¨ä¼šï¼Œéœ€è¦æå‰å‡†å¤‡å¥½PPTï¼Œä¼˜å…ˆçº§é«˜"
}
```

**æˆåŠŸå“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "title": "é¡¹ç›®å¯åŠ¨ä¼š",
  "description": "éœ€è¦æå‰å‡†å¤‡å¥½PPT",
  "priority": "high",
  "date": "2025-11-21",
  "timeOfDay": { "startTime": "09:00", "endTime": "10:00" }
}
```

> ğŸ’¡ è¿”å›çš„æ˜¯ `ScheduleForm` ç»“æ„ï¼Œå‰ç«¯å¯ç›´æ¥ç”¨äºåˆ›å»ºæ—¥ç¨‹ã€‚

---

### âœ… 6. è·å– AI ä¼˜åŒ–å»ºè®®ï¼ˆåŸºäºç°æœ‰æ—¥ç¨‹ï¼‰

**ç«¯ç‚¹**ï¼š`GET /schedule/{id}/ai/suggest`  
**ç”¨é€”**ï¼šä¸ºå·²æœ‰æ—¥ç¨‹ç”Ÿæˆä¼˜åŒ–å»ºè®®ï¼ˆå¦‚æ—¶é—´å®‰æ’ã€æè¿°æ¶¦è‰²ç­‰ï¼‰ã€‚

**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | `string` | æ—¥ç¨‹ID |

**æˆåŠŸå“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "suggestion": "å»ºè®®å°†ä¼šè®®æ—¶é—´è°ƒæ•´è‡³ä¸‹åˆ2ç‚¹ï¼Œé¿å¼€ä¸Šåˆçš„é‚®ä»¶é«˜å³°æœŸï¼Œæé«˜å‚ä¸åº¦ã€‚"
}
```

---

### âœ… 7. è·å– AI ä¼˜åŒ–å»ºè®®ï¼ˆåŸºäºç¼–è¾‘è‰ç¨¿ï¼‰

**ç«¯ç‚¹**ï¼š`POST /schedule/{id}/ai/suggest-by-edit`  
**ç”¨é€”**ï¼šåœ¨ç”¨æˆ·ç¼–è¾‘æ—¥ç¨‹æ—¶ï¼Œå®æ—¶ç”ŸæˆåŸºäºä¿®æ”¹å†…å®¹çš„å»ºè®®ã€‚

**è·¯å¾„å‚æ•°**ï¼š
| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `id` | `string` | æ—¥ç¨‹ID |

**è¯·æ±‚ä½“**ï¼ˆ`ModifyScheduleForm`ï¼‰ï¼š

```json
{
  "title": "ç´§æ€¥ä¿®å¤çº¿ä¸ŠBug",
  "priority": "high",
  "timeOfDay": { "startTime": "23:00", "endTime": "01:00" }
}
```

**æˆåŠŸå“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "suggestion": "æ·±å¤œå·¥ä½œå¯èƒ½å½±å“å¥åº·ï¼Œå»ºè®®æ‹†åˆ†ä¸ºä¸¤ä¸ªæ—¶é—´æ®µï¼š23:00-00:00 å’Œ 09:00-10:00"
}
```

---

## âš ï¸ é”™è¯¯ç è¯´æ˜

| çŠ¶æ€ç                       | åœºæ™¯                                                 |
| --------------------------- | ---------------------------------------------------- |
| `400 Bad Request`           | è¯·æ±‚å‚æ•°æ— æ•ˆï¼ˆå¦‚æ—¥æœŸæ ¼å¼é”™è¯¯ã€`dependentId` ä¸å­˜åœ¨ï¼‰ |
| `404 Not Found`             | æ—¥ç¨‹IDä¸å­˜åœ¨                                         |
| `409 Conflict`              | ä¾èµ–å†²çªï¼ˆå¦‚å¾ªç¯ä¾èµ–ï¼‰                               |
| `500 Internal Server Error` | AI æœåŠ¡å¼‚å¸¸æˆ–å†…éƒ¨é”™è¯¯                                |

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

1. **ä¾èµ–å…³ç³»å¤„ç†**ï¼š
   - åˆ›å»º/ä¿®æ”¹æ—¶ä¼  `dependentId`ï¼ˆå­—ç¬¦ä¸²IDï¼‰
   - æŸ¥è¯¢æ—¶è¿”å›å®Œæ•´çš„ `dependentSchedule` å¯¹è±¡ï¼ˆä¾¿äºå‰ç«¯å±•ç¤ºçˆ¶ä»»åŠ¡ä¿¡æ¯ï¼‰

2. **çŠ¶æ€æµè½¬é€»è¾‘**ï¼š
   - æ–°å»ºæ—¥ç¨‹ â†’ `pending`
   - æœ‰æœªå®Œæˆçš„çˆ¶ä»»åŠ¡ â†’ `locked`
   - çˆ¶ä»»åŠ¡å®Œæˆå â†’ è‡ªåŠ¨è½¬ä¸º `pending`
   - ç”¨æˆ·æ‰‹åŠ¨å®Œæˆ â†’ `done`

3. **AI åŠŸèƒ½é›†æˆ**ï¼š
   - åœ¨è¡¨å•é¡µé¢è°ƒç”¨ `/ai/generate` å¿«é€Ÿå¡«å……
   - ç¼–è¾‘æ—¶å®æ—¶è°ƒç”¨ `/ai/suggest-by-edit` æä¾›å»ºè®®

---

# ç”¨æˆ·è®¤è¯ API æ–‡æ¡£

**ç‰ˆæœ¬ï¼š1.0**  
**æœ€åæ›´æ–°ï¼š2025-11-20**

---

## ğŸŒŸ æ¦‚è¿°

æœ¬ API æä¾›ç”¨æˆ·èº«ä»½è®¤è¯æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬ç™»å½•ã€æ³¨å†Œå’Œç”¨æˆ·ä¿¡æ¯éªŒè¯ã€‚æ‰€æœ‰æ¥å£é‡‡ç”¨ RESTful é£æ ¼è®¾è®¡ï¼Œä½¿ç”¨ JSON æ ¼å¼é€šä¿¡ï¼Œå¹¶é€šè¿‡ JWTï¼ˆJSON Web Tokenï¼‰å®ç°æ— çŠ¶æ€è®¤è¯ã€‚

> ğŸ’¡ **å®‰å…¨è¯´æ˜**ï¼š
>
> - å¯†ç ä¼ è¾“éœ€é€šè¿‡ HTTPS åŠ å¯†
> - è¿”å›çš„ `token` åº”å­˜å‚¨åœ¨å‰ç«¯å®‰å…¨ä½ç½®ï¼ˆå¦‚ `HttpOnly` Cookie æˆ–å†…å­˜ä¸­ï¼‰
> - æ•æ„Ÿæ“ä½œå»ºè®®ç»“åˆçŸ­æœŸ token + åˆ·æ–°æœºåˆ¶

---

## ğŸ“¦ æ•°æ®æ¨¡å‹

### æ ¸å¿ƒå¯¹è±¡

#### `User`

```ts
{
  userId: string // ç”¨æˆ·å”¯ä¸€IDï¼ˆå¦‚ "usr_123456"ï¼‰
  username: string // ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰
  role: string // è§’è‰²æ ‡è¯†ï¼ˆå¦‚ "user", "admin"ï¼‰
}
```

#### `LoginResponse`

```ts
{
  userId: string
  username: string
  role: string
  token: string // JWT è®¤è¯ä»¤ç‰Œï¼ˆç”¨äºåç»­è¯·æ±‚é‰´æƒï¼‰
}
```

#### è¡¨å•ç±»å‹

| ç±»å‹           | å­—æ®µ                                      |
| -------------- | ----------------------------------------- |
| `LoginFrom`    | `username`, `password`                    |
| `RegisterFrom` | `username`, `password`, `confirmPassword` |

> âš ï¸ æ³¨æ„ï¼šå°½ç®¡ `registerApi` å½“å‰å‚æ•°ç±»å‹æ ‡æ³¨ä¸º `LoginFrom`ï¼Œå®é™…åº”ä¼ å…¥åŒ…å« `confirmPassword` çš„å®Œæ•´æ³¨å†Œè¡¨å•ï¼ˆå»ºè®®ä¿®æ­£ç±»å‹å®šä¹‰ï¼‰ã€‚

---

## ğŸ”Œ API æ¥å£è¯¦æƒ…

---

### âœ… 1. ç”¨æˆ·ç™»å½•

**ç«¯ç‚¹**ï¼š`POST /auth/login`  
**ç”¨é€”**ï¼šéªŒè¯ç”¨æˆ·å‡­æ®å¹¶é¢å‘è®¿é—®ä»¤ç‰Œã€‚

**è¯·æ±‚ä½“**ï¼ˆ`LoginFrom`ï¼‰ï¼š

```json
{
  "username": "alice",
  "password": "secure_password_123"
}
```

**æˆåŠŸå“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "userId": "usr_a1b2c3d4",
  "username": "alice",
  "role": "user",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.xxxxx"
}
```

**é”™è¯¯å“åº”**ï¼š

- `401 Unauthorized`ï¼šç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
- `400 Bad Request`ï¼šç¼ºå°‘å¿…å¡«å­—æ®µ

---

### âœ… 2. ç”¨æˆ·æ³¨å†Œ

**ç«¯ç‚¹**ï¼š`POST /auth/register`  
**ç”¨é€”**ï¼šåˆ›å»ºæ–°ç”¨æˆ·è´¦æˆ·ã€‚

**è¯·æ±‚ä½“**ï¼ˆåº”ä¸º `RegisterFrom`ï¼‰ï¼š

```json
{
  "username": "bob",
  "password": "my_new_password",
  "confirmPassword": "my_new_password" // å¿…é¡»ä¸ password ä¸€è‡´
}
```

**æˆåŠŸå“åº”**ï¼ˆ`201 Created`ï¼‰ï¼š

```json
{
  "userId": "usr_e5f6g7h8",
  "username": "bob",
  "role": "user",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.yyyyy"
}
```

**é”™è¯¯å“åº”**ï¼š

- `400 Bad Request`ï¼š
  - `password` ä¸ `confirmPassword` ä¸åŒ¹é…
  - ç”¨æˆ·åå·²å­˜åœ¨
  - å¯†ç å¼ºåº¦ä¸è¶³
- `422 Unprocessable Entity`ï¼šå‚æ•°æ ¼å¼æ— æ•ˆ

---

### âœ… 3. è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

**ç«¯ç‚¹**ï¼š`GET /auth/verify`  
**ç”¨é€”**ï¼šéªŒè¯å½“å‰ä¼šè¯æœ‰æ•ˆæ€§å¹¶è¿”å›ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼ˆéœ€æºå¸¦æœ‰æ•ˆ `token`ï¼‰ã€‚

**è¯·æ±‚å¤´**ï¼ˆå¿…é¡»ï¼‰ï¼š

```
Authorization: Bearer <your_token>
```

**æˆåŠŸå“åº”**ï¼ˆ`200 OK`ï¼‰ï¼š

```json
{
  "userId": "usr_a1b2c3d4",
  "username": "alice",
  "role": "user"
}
```

**é”™è¯¯å“åº”**ï¼š

- `401 Unauthorized`ï¼šToken æ— æ•ˆã€è¿‡æœŸæˆ–ç¼ºå¤±
- `403 Forbidden`ï¼šToken æœ‰æ•ˆä½†æƒé™ä¸è¶³ï¼ˆç½•è§ï¼‰

---

## ğŸ” è®¤è¯æµç¨‹ç¤ºä¾‹

```mermaid
sequenceDiagram
    participant Client
    participant Server

    Client->>Server: POST /auth/login {username, password}
    alt ç™»å½•æˆåŠŸ
        Server-->>Client: {userId, username, role, token}
        Client->>LocalStorage: ä¿å­˜ token
    else ç™»å½•å¤±è´¥
        Server-->>Client: 401 Unauthorized
    end

    Client->>Server: GET /auth/verify (å¸¦ Authorization å¤´)
    Server-->>Client: {userId, username, role} æˆ– 401
```

---

## âš ï¸ å®‰å…¨æœ€ä½³å®è·µ

1. **å‰ç«¯**ï¼š
   - ä¸è¦å°† `token` å­˜å‚¨åœ¨ `localStorage`ï¼ˆæ˜“å— XSS æ”»å‡»ï¼‰
   - æ¨èæ–¹æ¡ˆï¼šå†…å­˜å­˜å‚¨ + çŸ­æœŸæœ‰æ•ˆæœŸ + åˆ·æ–°ä»¤ç‰Œæœºåˆ¶

2. **åç«¯**ï¼š
   - å¯†ç å¿…é¡»åŠ ç›å“ˆå¸Œå­˜å‚¨ï¼ˆå¦‚ bcryptï¼‰
   - å®æ–½ç™»å½•å¤±è´¥æ¬¡æ•°é™åˆ¶
   - Token è®¾ç½®åˆç†è¿‡æœŸæ—¶é—´ï¼ˆå¦‚ 15-30 åˆ†é’Ÿï¼‰

3. **ç½‘ç»œ**ï¼š
   - æ‰€æœ‰è®¤è¯æ¥å£å¼ºåˆ¶ HTTPS
   - æ•æ„Ÿå“åº”ç¦ç”¨ç¼“å­˜ï¼ˆ`Cache-Control: no-store`ï¼‰

---

# åŒTokenæ— æ„Ÿåˆ·æ–° API æ¥å£æ–‡æ¡£

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†åŒTokenè®¤è¯ç³»ç»Ÿçš„APIæ¥å£ï¼Œç”¨äºå®ç°æ— æ„Ÿåˆ·æ–°æœºåˆ¶ã€‚ç³»ç»Ÿä½¿ç”¨Access Tokenå’ŒRefresh Tokené…å¯¹ï¼Œæå‡å®‰å…¨æ€§å’Œç”¨æˆ·ä½“éªŒã€‚

## åŸºç¡€ä¿¡æ¯

- **Base URL**: `/api/auth`
- **è®¤è¯æ–¹å¼**: Bearer Token (Access Token)
- **Content-Type**: `application/json`

## æ¥å£åˆ—è¡¨

### 1. ç”¨æˆ·ç™»å½•

è·å–åˆå§‹çš„Access Tokenå’ŒRefresh Tokenã€‚

**Endpoint**: `POST /api/auth/login`

**è¯·æ±‚å¤´**:

```javascript
Content-Type: application/json
```

**è¯·æ±‚ä½“**:

```json
{
  "username": "string, å¿…å¡«, ç”¨æˆ·å",
  "password": "string, å¿…å¡«, å¯†ç "
}
```

**æˆåŠŸå“åº”** (200):

```json
{
  "success": true,
  "data": {
    "accessToken": "string, Access Token",
    "refreshToken": "string, Refresh Token",
    "expiresIn": 900,
    "tokenType": "Bearer",
    "user": {
      "id": "string, ç”¨æˆ·ID",
      "username": "string, ç”¨æˆ·å",
      "email": "string, é‚®ç®±"
    }
  }
}
```

**é”™è¯¯å“åº”**:

- 401: ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯
- 400: è¯·æ±‚å‚æ•°ç¼ºå¤±

### 2. Tokenåˆ·æ–°

ä½¿ç”¨Refresh Tokenè·å–æ–°çš„Access Tokenã€‚

**Endpoint**: `POST /api/auth/refresh`

**è¯·æ±‚å¤´**:

```javascript
Content-Type: application/json
Authorization: Bearer <Refresh Token>
```

**è¯·æ±‚ä½“**: æ— 

**æˆåŠŸå“åº”** (200):

```json
{
  "success": true,
  "data": {
    "accessToken": "string, æ–°çš„Access Token",
    "refreshToken": "string, æ–°çš„Refresh Token",
    "expiresIn": 900,
    "tokenType": "Bearer"
  }
}
```

**é”™è¯¯å“åº”**:

- 401: Refresh Tokenæ— æ•ˆæˆ–å·²è¿‡æœŸ
- 403: Refresh Tokenå·²è¢«æ’¤é”€

### 3. ç”¨æˆ·ç™»å‡º

ä½¿å½“å‰çš„æ‰€æœ‰Tokenå¤±æ•ˆã€‚

**Endpoint**: `POST /api/auth/logout`

**è¯·æ±‚å¤´**:

```javascript
Content-Type: application/json
Authorization: Bearer <Access Token>
```

**è¯·æ±‚ä½“**: æ— 

**æˆåŠŸå“åº”** (200):

```json
{
  "success": true,
  "message": "ç™»å‡ºæˆåŠŸ"
}
```

### 4. TokenéªŒè¯

éªŒè¯Access Tokençš„æœ‰æ•ˆæ€§ã€‚

**Endpoint**: `GET /api/auth/verify`

**è¯·æ±‚å¤´**:

```javascript
Authorization: Bearer <Access Token>
```

**æˆåŠŸå“åº”** (200):

```json
{
  "success": true,
  "data": {
    "valid": true,
    "user": {
      "id": "string, ç”¨æˆ·ID",
      "username": "string, ç”¨æˆ·å"
    }
  }
}
```

**é”™è¯¯å“åº”**:

- 401: Tokenæ— æ•ˆæˆ–å·²è¿‡æœŸ

### 5. å¼ºåˆ¶ç™»å‡º

ç®¡ç†å‘˜å¼ºåˆ¶ä½¿ç”¨æˆ·çš„æ‰€æœ‰Tokenå¤±æ•ˆã€‚

**Endpoint**: `POST /api/auth/revoke`

**è¯·æ±‚å¤´**:

```javascript
Content-Type: application/json
Authorization: Bearer <Access Token>
```

**è¯·æ±‚ä½“**:

```json
{
  "userId": "string, è¦æ’¤é”€çš„ç”¨æˆ·ID"
}
```

**æˆåŠŸå“åº”** (200):

```json
{
  "success": true,
  "message": "ç”¨æˆ·Tokenå·²æ’¤é”€"
}
```

## Tokené…ç½®

- **Access Tokenæœ‰æ•ˆæœŸ**: 15åˆ†é’Ÿ

- **Refresh Tokenæœ‰æ•ˆæœŸ**: 7å¤©

- **Tokenå­˜å‚¨**:
  - Access Token: å®¢æˆ·ç«¯å†…å­˜æˆ–localStorage
  - Refresh Token: HttpOnly Cookie (æ¨è) æˆ–å®‰å…¨å­˜å‚¨

## é”™è¯¯ç è¯´æ˜

- `TOKEN_EXPIRED`: Access Tokenè¿‡æœŸï¼Œéœ€è¦åˆ·æ–°
- `REFRESH_TOKEN_EXPIRED`: Refresh Tokenè¿‡æœŸï¼Œéœ€è¦é‡æ–°ç™»å½•
- `TOKEN_REVOKED`: Tokenå·²è¢«æ’¤é”€
- `INVALID_TOKEN`: Tokenæ ¼å¼é”™è¯¯æˆ–æ— æ•ˆ

## å‰ç«¯é›†æˆç¤ºä¾‹

### è‡ªåŠ¨åˆ·æ–°æµç¨‹

```javascript
// è¯·æ±‚æ‹¦æˆªå™¨
axios.interceptors.response.use(
  (response) => response,
  async (error) => {
    if (error.response.status === 401 && error.response.data.code === 'TOKEN_EXPIRED') {
      // è‡ªåŠ¨åˆ·æ–°token
      const newToken = await refreshToken()
      // é‡è¯•åŸå§‹è¯·æ±‚
      return axios.request(error.config)
    }
    return Promise.reject(error)
  },
)
```

è¿™ä¸ªæ¥å£æ–‡æ¡£æ¶µç›–äº†åŒtokenç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½ã€‚å¦‚æœæ‚¨å¯¹è¿™äº›æ¥å£è®¾è®¡æ»¡æ„ï¼Œæˆ‘å¯ä»¥å¼€å§‹å®ç°å…·ä½“çš„ä»£ç ã€‚
